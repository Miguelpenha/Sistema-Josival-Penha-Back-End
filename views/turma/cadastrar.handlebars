<style>
    #form {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 40%;
        background-color: #ffffff;
        margin-top: 5%;
        border-radius: 12px;
    }

    .campo-jt {
        margin: 0;
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 90%;
    }

    .campo-btn {
        margin: 0;
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 80%;
        padding-bottom: 5%;
    }

    .btn {
        font-size: 1.5vw;
        width: 100%;
        background-color: #049DD9;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        display: block;
        margin-right: auto;
        margin-left: auto;
        border-radius: 12px;
        margin-top: 3%;
        transition-timing-function: linear;
        transition-duration: 0.2s;
    }

    .btn:hover {
        background-color: #049dd9d3;
    }

    .campo {
        margin: 0;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    input[type=text], input[type=tel] {
        padding: 12px 20px;
        margin: 8px 0;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
        transition-timing-function: linear;
        transition-duration: 0.2s;
    }

    .form-label {
        display: block;
        margin-left: auto;
        margin-right: auto;
        color: #049DD9;
    }

    .tit {
        color: #049DD9;
        padding-top: 6%;
        padding-bottom: 2%;
        text-align: center;
        font-size: 4vw;
    }

    .sep {
        background-color: #049DD9;
        padding-top: 0.3%;
    }

    .bi-arrow-left-circle {
        color: #ffffff;
        margin-left: 1%;
        margin-top: 1%;
    }

    .btn-voltar-link {
        transition-timing-function: linear;
        transition-duration: 0.2s;
    }

    .btn-voltar-link:hover {
        transition-timing-function: linear;
        transition-duration: 0.2s;
        opacity: 80%;
    }

    #erro-nome {
        padding: 1.5%;
        display: none;
        margin-bottom: 0;
    }

    #erro-nome-txt {
        margin-left: 1%;
    }
</style>

<input type="hidden" name="data" id="data" value="{{data}}">
{{#if voltar}}
    <btn-voltar voltar="{{voltar}}"></btn-voltar>
{{else}}
    <btn-voltar voltar="/turmas"></btn-voltar>
{{/if}}
<form action="/turmas/cadastrar-veri" id="form" class="row" method="POST">
    <div class="row">
        <h1 class="tit">Cadastro da turma</h1>
    </div>
    <div class="row">
        <hr class="sep">
    </div>
    <br>
    <div class="row campo-jt">
        <div class="row label">
            <h4 class="form-label">Nome</h4>
        </div>
        <div class="row campo">
            <input type="text" class="form-control" id="nome" name="nome" placeholder="Digite o nome" required>
            <div class="alert alert-danger" role="alert" id="erro-nome">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-exclamation-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                    <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
                </svg>
                <span id="erro-nome-txt"></span>
            </div>
        </div>
    </div>
    <br>
    <div class="row campo-jt">
        <div class="row label">
            <h4 class="form-label">Série</h4>
        </div>
        <div class="row campo">
            <select class="form-select" aria-label="Selecione a série" required name="serie" id="serie">
                <option selected value="padrão">Selecione a série</option>
                <option value="Infantil 1">Infantil 1</option>
                <option value="Infantil 2">Infantil 2</option>
                <option value="Infantil 3">Infantil 3</option>
                <option value="1° ano">1° ano</option>
                <option value="2° ano">2° ano</option>
                <option value="3° ano">3° ano</option>
                <option value="4° ano">4° ano</option>
                <option value="5° ano">5° ano</option>
            </select>
        </div>
    </div>
    <br>
    <div class="row campo-jt">
        <div class="row label">
            <h4 class="form-label">Turno</h4>
        </div>
        <div class="row campo">
            <select class="form-select" aria-label="Selecione o turno" required name="turno" id="turno">
                <option selected value="padrão">Selecione o turno</option>
                <option value="Manhã">Manhã</option>
                <option value="Tarde">Tarde</option>
                <option value="Noite">Noite</option>
            </select>
        </div>
    </div>
    <br>
    <div class="row campo-jt">
        <div class="row label">
            <h4 class="form-label">Professora</h4>
        </div>
        <div class="row campo">
            <select class="form-select" aria-label="Selecione a professora" required name="professora" id="professora">
                <option selected value="padrão">Selecione a professora</option>
                {{#each professoras}}
                    <option value="{{this.nome}}">{{this.nome}}</option>
                {{/each}}
            </select>
        </div>
    </div>
    <br>
    <div class="row campo-btn">
        <button class="btn btn-primary" id="btn">Confirmar</button>
    </div>
    <br>
</form>
<br>
<br>
<br>
<br>
<br>
<script>
    const nome = $('#nome')
    const erroNome = window.document.getElementById('erro-nome')
    const erroNomeTxt = window.document.getElementById('erro-nome-txt')
    $('#form').submit(ev => {
        const serie = $('#serie')
        const turno = $('#turno')
        if (serie.val() === 'padrão') {
            ev.preventDefault()
            serie.focus()
        } else if (turno.val() === 'padrão') {
            ev.preventDefault()
            turno.focus()
        }
        if (erroNome.style.display == 'block') {
            nome.focus()
            ev.preventDefault()
        }
    })
    nome.keyup(() => {
        if (nome.val().length > 0) {
            socket.emit('turmaVeriCadas', nome.val())
        }
    })
    socket.on('turmaVeriCadasRes', existe => {
        if (existe) {
            erroNome.style.display = 'block'
            erroNomeTxt.innerText = 'Já existe uma turma com esse nome'
        } else {
            erroNome.style.display = 'none'
            erroNomeTxt.innerText = ''
        }
    })
</script>